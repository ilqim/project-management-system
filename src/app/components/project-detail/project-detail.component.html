<div class="project-detail" *ngIf="project as p">
  <header class="detail-header">
    <button class="back-btn" (click)="goBack()">&larr; Geri</button>
    <h2>{{ p.name }}</h2>
  </header>

  <section class="info" *ngIf="!loading">
    <p class="description">{{ p.description }}</p>
    <p><strong>Durum:</strong> {{ p.status }}</p>
    <p><strong>Başlangıç:</strong> {{ p.startDate | date:'shortDate' }}</p>
    <p *ngIf="p.endDate"><strong>Bitiş:</strong> {{ p.endDate | date:'shortDate' }}</p>
    <p><strong>İlerleme:</strong> {{ p.progress || 0 }}%</p>

    <div class="members" *ngIf="p.teamMembers?.length">
      <h3>Takım Üyeleri</h3>
      <ul>
        <li *ngFor="let id of p.teamMembers">
          {{ getMemberName(id) }}
          <button
            *ngIf="canManage() && id !== currentUser?.id"
            class="assign-btn"
            (click)="assignTask(id)"
          >Görev Ver</button>
          <ul class="member-tasks" *ngIf="memberTasks[id]?.length">
            <li *ngFor="let task of memberTasks[id]">{{ task.title }}</li>
          </ul>
        </li>
      </ul>
    </div>
  </section>

  <section class="actions" *ngIf="canManage()">
    <button class="btn" (click)="editProject()">Projeyi Düzenle</button>
    <button class="btn" (click)="manageTeam()">Takım Yönetimi</button>
  </section>

  <p class="readonly" *ngIf="!canManage()">Bu projeyi düzenleme yetkiniz yok.</p>


  <div class="loading" *ngIf="loading">Projeler yükleniyor...</div>
</div>